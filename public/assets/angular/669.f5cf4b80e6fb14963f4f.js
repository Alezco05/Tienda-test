"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[669],{9669:(R,_,r)=>{r.r(_),r.d(_,{FormProductoComponent:()=>F});var g=r(8239),n=r(3679),p=r(2238),f=r(6738),s=r(8654),T=r(6889),u=r(5755),t=r(7716),Z=r(2458),h=r(8104),A=r(8583),c=r(8295),E=r(7441),b=r(9983),d=r(3220),v=r(1095),D=r(7091);function P(o,i){if(1&o&&(t.TgZ(0,"div",null,1),t.TgZ(2,"h1"),t._uU(3),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.hij(" Actualizar ",e.data.nombreProducto,"")}}function O(o,i){1&o&&(t.TgZ(0,"h1"),t._uU(1,"Crear Producto"),t.qZA())}function C(o,i){1&o&&(t.TgZ(0,"mat-icon",28),t._uU(1,"folder"),t.qZA())}function I(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(l){return t.CHM(e),t.oxw(),t.MAs(10).clear(l)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA(),t.qZA()}}function M(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," El n\xfamero maximo de imagenes son dos. "),t.qZA())}function U(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"byteFormat"),t.ALo(3,"byteFormat"),t.qZA()),2&o){const e=t.oxw();let a;t.xp6(1),t.AsE(" El tama\xf1o total no debe exceder ",t.lcZ(2,2,null==(a=e.form.get("file"))?null:a.getError("maxContentSize").maxSize)," (",t.lcZ(3,4,null==(a=e.form.get("file"))?null:a.getError("maxContentSize").actualSize),"). ")}}function q(o,i){if(1&o&&(t.TgZ(0,"mat-option",30),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.nombre)}}function x(o,i){if(1&o&&(t.TgZ(0,"mat-option",30),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}let F=(()=>{class o{constructor(e,a,l,m,S){this.formBuilder=e,this.dialogRef=a,this.data=l,this.dateAdapter=m,this.dataService=S,this.unsubscribeSignal=new T.x,this.myFormData=new FormData,this.tallas=["S","M","L","XL","XLL"],this.marcas=[],this.dateAdapter.setLocale("es"),this.dateAdapter.getFirstDayOfWeek=()=>1,this.dataService.getAllData("getMarcas").pipe((0,u.R)(this.unsubscribeSignal.asObservable())).subscribe({next:L=>this.marcas=L})}ngOnInit(){this.makeForm(),this.data&&this.fillData()}makeForm(){this.form=this.formBuilder.group({file:["",[s.CU.maxContentSize(3e6)]],nombreProducto:["",[n.kI.required,n.kI.minLength(4),n.kI.maxLength(100)]],talla:["",[n.kI.required]],marca_id:["",[n.kI.required]],observaciones:["",[n.kI.required,n.kI.minLength(4),n.kI.maxLength(250)]],cantidad:[0,[n.kI.required,n.kI.pattern(/^-?(0|[1-9]\d*)?$/)]],fechaEmbarque:["",[n.kI.required]]})}fillData(){Object.keys(this.form.controls).forEach(e=>{this.data[e]&&this.form.get(e).setValue(this.data[e].toString())}),this.form.get("file").setValidators(null)}fileEvent(e){try{this.myFormData=new FormData,this.myFormData.append("image",e.target.files[0])}catch(a){}}onSubmit(){const e=Object.assign({},this.form.value);e.fechaEmbarque=f(this.form.get("fechaEmbarque").value).format("YYYY-MM-DD"),this.data?this.updateProduct(e):this.createProduct(e)}updateProduct(e){var a=this;return(0,g.Z)(function*(){yield a.uploadFile(a.data.id),a.dataService.putData("producto",a.data.id,e).pipe((0,u.R)(a.unsubscribeSignal.asObservable())).subscribe({next:()=>a.dataService.presentSwall("Exito!","Dato Actualizado","success",2e3),error:()=>a.dataService.presentSwall("Error!","Ha sucedido algo inesperado","danger",2e3),complete:()=>a.dialogRef.close()})})()}createProduct(e){this.dataService.postData("producto",e).pipe((0,u.R)(this.unsubscribeSignal.asObservable())).subscribe({next:a=>{this.dataService.presentSwall("Exito!","Dato Creado","success",2e3),""!=this.form.get("file").value?this.uploadFile(a.producto.id).then(()=>this.dialogRef.close()).catch(()=>{this.dataService.presentSwall("Error!","Ha sucedido algo inesperado","danger",2e3)}):this.dialogRef.close()},error:()=>this.dataService.presentSwall("Error!","Ha sucedido algo inesperado","danger",2e3)})}uploadFile(e){var a=this;return(0,g.Z)(function*(){a.myFormData.append("id",e),""!=a.form.get("file").value&&(yield a.dataService.uploadImage("productoImg",a.myFormData).pipe((0,u.R)(a.unsubscribeSignal.asObservable())).subscribe(console.log))})()}ngOnDestroy(){this.unsubscribeSignal.next(),this.unsubscribeSignal.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.qu),t.Y36(p.so),t.Y36(p.WI,8),t.Y36(Z._A),t.Y36(h.D))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form-producto"]],decls:66,vars:12,consts:[[4,"ngIf"],["else",""],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-6","col-12"],["formControlName","file","placeholder","Subir Imagen",3,"accept","change"],["removableInput",""],["matSuffix","",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["appearance","legacy",1,"w-100"],["formControlName","marca_id"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-8","col-12"],["matInput","","placeholder","Nombre del producto","formControlName","nombreProducto"],[1,"col-md-4","col-12"],["formControlName","talla"],[1,"row","mb-md-3"],["matInput","","placeholder","","type","number","formControlName","cantidad"],["matInput","","formControlName","fechaEmbarque",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],[1,"col-12"],["matInput","","placeholder","Descripci\xf3n detallada del producto que brinda...","formControlName","observaciones"],[1,"row","mb-4"],[1,"col-6","d-grid","gap-2"],["mat-stroked-button","","color","primary","type","submit",1,"btn",3,"disabled"],[1,"ms-2"],["mat-stroked-button","","color","warn","type","button",1,"btn",3,"click"],["matSuffix",""],["mat-icon-button","","matSuffix","",3,"click"],[3,"value"]],template:function(e,a){if(1&e&&(t.YNc(0,P,4,1,"div",0),t.YNc(1,O,2,0,"ng-template",null,1,t.W1O),t._UZ(3,"hr"),t.TgZ(4,"form",2),t.NdJ("ngSubmit",function(){return a.onSubmit()}),t.TgZ(5,"h2"),t._uU(6,"Imagen Producto"),t.qZA(),t.TgZ(7,"div",3),t.TgZ(8,"mat-form-field",4),t.TgZ(9,"ngx-mat-file-input",5,6),t.NdJ("change",function(m){return a.fileEvent(m)}),t.qZA(),t.YNc(11,C,2,0,"mat-icon",7),t.YNc(12,I,3,0,"button",8),t.YNc(13,M,2,0,"mat-error",0),t.YNc(14,U,4,6,"mat-error",0),t.qZA(),t.TgZ(15,"div",4),t.TgZ(16,"mat-form-field",9),t.TgZ(17,"mat-label"),t._uU(18,"Marca"),t.qZA(),t.TgZ(19,"mat-select",10),t.YNc(20,q,2,2,"mat-option",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"div",3),t.TgZ(22,"div",12),t.TgZ(23,"mat-form-field",9),t.TgZ(24,"mat-label"),t._uU(25,"Nombre del producto"),t.qZA(),t._UZ(26,"input",13),t.qZA(),t.qZA(),t.TgZ(27,"div",14),t.TgZ(28,"mat-form-field",9),t.TgZ(29,"mat-label"),t._uU(30,"Talla"),t.qZA(),t.TgZ(31,"mat-select",15),t.YNc(32,x,2,2,"mat-option",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"div",16),t.TgZ(34,"div",4),t.TgZ(35,"mat-form-field",9),t.TgZ(36,"mat-label"),t._uU(37,"Cantidad"),t.qZA(),t._UZ(38,"input",17),t.qZA(),t.qZA(),t.TgZ(39,"div",4),t.TgZ(40,"mat-form-field",9),t.TgZ(41,"mat-label"),t._uU(42,"Fecha de Embarque "),t.qZA(),t._UZ(43,"input",18),t._UZ(44,"mat-datepicker-toggle",19),t._UZ(45,"mat-datepicker",null,20),t.qZA(),t.qZA(),t.qZA(),t.TgZ(47,"div",3),t.TgZ(48,"div",21),t.TgZ(49,"mat-form-field",9),t.TgZ(50,"mat-label"),t._uU(51,"Observaciones del producto"),t.qZA(),t._UZ(52,"textarea",22),t.qZA(),t.qZA(),t.qZA(),t.TgZ(53,"div",23),t.TgZ(54,"div",24),t.TgZ(55,"button",25),t.TgZ(56,"mat-icon"),t._uU(57,"done"),t.qZA(),t.TgZ(58,"span",26),t._uU(59," Aceptar"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(60,"div",24),t.TgZ(61,"button",27),t.NdJ("click",function(){return a.dialogRef.close()}),t.TgZ(62,"mat-icon"),t._uU(63,"close"),t.qZA(),t.TgZ(64,"span",26),t._uU(65," Cancelar"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const l=t.MAs(10),m=t.MAs(46);t.Q6J("ngIf",a.data),t.xp6(4),t.Q6J("formGroup",a.form),t.xp6(5),t.Q6J("accept",".jpg,.jpeg,.png,.gif"),t.xp6(2),t.Q6J("ngIf",l.empty),t.xp6(1),t.Q6J("ngIf",!l.empty),t.xp6(1),t.Q6J("ngIf",null==a.form.get("file").errors?null:a.form.get("file").errors.invalidNumber),t.xp6(1),t.Q6J("ngIf",a.form.get("file").hasError("maxContentSize")),t.xp6(6),t.Q6J("ngForOf",a.marcas),t.xp6(12),t.Q6J("ngForOf",a.tallas),t.xp6(11),t.Q6J("matDatepicker",m),t.xp6(1),t.Q6J("for",m),t.xp6(11),t.Q6J("disabled",!a.form.valid)}},directives:[A.O5,n._Y,n.JL,n.sg,c.KE,s.Yh,n.JJ,n.u,c.hX,E.gD,A.sg,b.Nt,n.Fj,n.wV,d.hl,d.nW,c.R9,d.Mq,v.lW,D.Hw,c.TO,Z.ey],pipes:[s.xh],styles:[""]}),o})()}}]);